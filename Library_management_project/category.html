<!DOCTYPE html>
<html>
<head>
</head>
<body>
    <h2>Categories</h2>
    <button onclick="window.location.href = 'http://localhost:55391/addnewcategory.html';">
        Add New Category
    </button>







    <meta charset="utf-8" />
    <table border="1" id="categorytable">
    </table>
    <table border="1" id="booktable">
    </table>
    <!--<form id="categoryform">
            category id<input type="text" name="categoryid" id="cid" />
            category name<input type="text" name="categoryname" id="cname" />
            category description<input type="text" name="categorydes" id="cdes" />





            <input type="button" id="Save" value="Save Data" />
    </form>-->



    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript">$(document).ready(function () {



            $.ajax({
                type: "GET",
                url: "http://localhost:55391/api/values",
                contentType: "application/json; charset=utf-8",
                dataType: "json",





                success: function (response) {





                    var tbltop = '<table border=1><tr><th>Category_Id</th><th>Category_Name</th><th>Category_Description</th></tr>';



                    var main = "";



                    for (i = 0; i < response.length; i++) {



                        main += "<tr><td>" + response[i].Category_Id + "</td><td>" + response[i].Category_Name + "</td><td>" + response[i].Category_Description + "</td ><td >" + " " + "<button onclick='editcategory(" + response[i].Category_Id + ")'> Edit </button> | <button onclick='deletebook(" + response[i].Category_Id + ")'> Delete </button> | <button onclick = 'viewbook(" + response[i].Category_Id + ")'> View Books </button >" + "</td></tr>";



                    }



                    var tblbottom = "</table>";



                    var tbl = tbltop + main + tblbottom;



                    console.log(response);



                    document.getElementById('categorytable').innerHTML = tbl;



                },



                failure: function (response) {
                    alert(response.responseText);
                    alert("Failure");
                },
                error: function (response) {
                    alert(response);
                    alert("Error");
                }



            });



        });





        function deletebook(Category_Id) {
            $.ajax({
                url: "http://localhost:55391/api/values/" + Category_Id,
                type: "DELETE",
                success: function () {
                    alert('record has been deleted');
                    refresh();
                },
                error: function (error) {
                    alert(error);
                }
            });
        }
        function getcategory() {
            $.ajax({
                type: "GET",
                url: "http://localhost:55391/api/values",
                contentType: "application/json; charset=utf-8",
                dataType: "json",





                success: function (response) {





                    var tbltop = '<table border=1><tr><th>Category_Id</th><th>Category_Name</th><th>Category_Description</th></tr>';



                    var main = "";



                    for (i = 0; i < response.length; i++) {



                        main += "<tr><td>" + response[i].Category_Id + "</td><td>" + response[i].Category_Name + "</td><td>" + response[i].Category_Description + "</td ><td >" + " " + "<button onclick='editcategory(" + response[i].Category_Id + ")'> Edit </button> | <button onclick='deletebook(" + response[i].Category_Id + ")'> Delete </button> | <button onclick = 'viewbook(" + response[i].Category_Id + ")'> View Books </button >" + "</td></tr>";



                    }



                    var tblbottom = "</table>";



                    var tbl = tbltop + main + tblbottom;



                    console.log(response);



                    document.getElementById('categorytable').innerHTML = tbl;



                },



                failure: function (response) {
                    alert(response.responseText);
                    alert("Failure");
                },
                error: function (response) {
                    alert(response);
                    alert("Error");
                }



            });
        }
        function viewbook(Category_Id) {
            $.ajax({
                type: "GET",
                url: "http://localhost:55391/api/Book?cid=" + Category_Id,
                contentType: "application/json; charset=utf-8",
                dataType: "json",





                success: function (response) {







                    var tbltop = '<table border=1><tr><th>Book_Id</th><th>Book_Title</th><th>Book_Description</th><th>Author_Name</th><th>Available_Quantity</th></tr>';



                    var main = "";



                    for (i = 0; i < response.length; i++) {



                        main += "<tr><td>" + response[i].Book_Id + "</td><td>" + response[i].Book_Title + "</td ><td >" + response[i].Book_Description + "</td ><td >" + response[i].Author_Name + "</td ><td >" + + response[i].Available_Quantity + "</td ><td >" + " " + "<button onclick='edit(" + response[i].Book_Id + " )'> Edit </button> | <button onclick='deletebook(" + response[i].Book_Id + ")'> Delete </button>" + "</td></tr>";



                    }



                    var tblbottom = "</table>";



                    var tbl = tbltop + main + tblbottom;



                    console.log(response);



                    document.getElementById('booktable').innerHTML = tbl;



                    ////Add/Append the formatted values of ListValue variable into ID called "MemberList"
                    //$("#Category").append(ListValue);
                },
                failure: function (response) {
                    alert(response.responseText);
                    alert("Failure");
                },
                error: function (response) {
                    alert(response);
                    alert("Error");
                }
            });



        }
        function editcategory() {
            window.location.href = 'http://localhost:55391/Editcategory.html'
        }





        function refresh() {
            window.location.href = 'http://localhost:55391/category.html'
        }</script>



</body>
</html>